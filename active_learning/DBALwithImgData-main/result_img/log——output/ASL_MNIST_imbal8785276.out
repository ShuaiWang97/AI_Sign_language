/home/wangsh/DBALwithImgData-main/main.py:10: DeprecationWarning: Please use `gaussian_filter1d` from the `scipy.ndimage` namespace, the `scipy.ndimage.filters` namespace is deprecated.
  from scipy.ndimage.filters import gaussian_filter1d
Using device: cuda:0
DataLoader :  <load_data.LoadASL_imbal_Data object at 0x1507e2ddadc0>

---------- Start uniform-MC_dropout=True training! ----------
********** Experiment Iterations: 1/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4500
test Accuracy after query 5: 0.3814
Val Accuracy after query 10: 0.6100
test Accuracy after query 10: 0.4206
Val Accuracy after query 15: 0.6500
test Accuracy after query 15: 0.5042
Val Accuracy after query 20: 0.7100
test Accuracy after query 20: 0.5436
Val Accuracy after query 25: 0.7800
test Accuracy after query 25: 0.5502
Val Accuracy after query 30: 0.8500
test Accuracy after query 30: 0.5660
Val Accuracy after query 35: 0.8100
test Accuracy after query 35: 0.6018
Val Accuracy after query 40: 0.8200
test Accuracy after query 40: 0.5926
Val Accuracy after query 45: 0.8900
test Accuracy after query 45: 0.6506
Val Accuracy after query 50: 0.8700
test Accuracy after query 50: 0.6428
Val Accuracy after query 55: 0.8900
test Accuracy after query 55: 0.6528
Val Accuracy after query 60: 0.9100
test Accuracy after query 60: 0.6728
Val Accuracy after query 65: 0.9200
test Accuracy after query 65: 0.6660
Val Accuracy after query 70: 0.9400
test Accuracy after query 70: 0.6864
Val Accuracy after query 75: 0.9200
test Accuracy after query 75: 0.6980
Val Accuracy after query 80: 0.9300
test Accuracy after query 80: 0.7160
Val Accuracy after query 85: 0.9200
test Accuracy after query 85: 0.7072
Val Accuracy after query 90: 0.9100
test Accuracy after query 90: 0.7394
Val Accuracy after query 95: 0.9100
test Accuracy after query 95: 0.7430
Val Accuracy after query 100: 0.9200
test Accuracy after query 100: 0.7548
Val Accuracy after query 105: 0.9100
test Accuracy after query 105: 0.7724
Val Accuracy after query 110: 0.9200
test Accuracy after query 110: 0.7674
Val Accuracy after query 115: 0.9300
test Accuracy after query 115: 0.7820
Val Accuracy after query 120: 0.9200
test Accuracy after query 120: 0.7718
Val Accuracy after query 125: 0.9200
test Accuracy after query 125: 0.7950
Val Accuracy after query 130: 0.9300
test Accuracy after query 130: 0.7960
Val Accuracy after query 135: 0.9500
test Accuracy after query 135: 0.7928
Val Accuracy after query 140: 0.9400
test Accuracy after query 140: 0.7932
Val Accuracy after query 145: 0.9500
test Accuracy after query 145: 0.8108
Val Accuracy after query 150: 0.9300
test Accuracy after query 150: 0.8072
********** Test Accuracy per experiment: 0.8072 **********
********** Experiment 1 (uniform-MC_dropout=True): 0:6:7 **********
********** Experiment Iterations: 2/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.3900
test Accuracy after query 5: 0.3728
Val Accuracy after query 10: 0.5700
test Accuracy after query 10: 0.3930
Val Accuracy after query 15: 0.5600
test Accuracy after query 15: 0.4466
Val Accuracy after query 20: 0.6600
test Accuracy after query 20: 0.4912
Val Accuracy after query 25: 0.7000
test Accuracy after query 25: 0.5294
Val Accuracy after query 30: 0.7500
test Accuracy after query 30: 0.5496
Val Accuracy after query 35: 0.7800
test Accuracy after query 35: 0.5926
Val Accuracy after query 40: 0.8000
test Accuracy after query 40: 0.6412
Val Accuracy after query 45: 0.8200
test Accuracy after query 45: 0.6454
Val Accuracy after query 50: 0.8300
test Accuracy after query 50: 0.6118
Val Accuracy after query 55: 0.8200
test Accuracy after query 55: 0.6538
Val Accuracy after query 60: 0.8400
test Accuracy after query 60: 0.6688
Val Accuracy after query 65: 0.8500
test Accuracy after query 65: 0.6580
Val Accuracy after query 70: 0.8300
test Accuracy after query 70: 0.6756
Val Accuracy after query 75: 0.8400
test Accuracy after query 75: 0.7022
Val Accuracy after query 80: 0.8700
test Accuracy after query 80: 0.7018
Val Accuracy after query 85: 0.8600
test Accuracy after query 85: 0.7120
Val Accuracy after query 90: 0.8700
test Accuracy after query 90: 0.7214
Val Accuracy after query 95: 0.8800
test Accuracy after query 95: 0.7400
Val Accuracy after query 100: 0.9100
test Accuracy after query 100: 0.7746
Val Accuracy after query 105: 0.9000
test Accuracy after query 105: 0.7670
Val Accuracy after query 110: 0.9200
test Accuracy after query 110: 0.7656
Val Accuracy after query 115: 0.9200
test Accuracy after query 115: 0.7744
Val Accuracy after query 120: 0.9200
test Accuracy after query 120: 0.7738
Val Accuracy after query 125: 0.9100
test Accuracy after query 125: 0.7560
Val Accuracy after query 130: 0.9100
test Accuracy after query 130: 0.7954
Val Accuracy after query 135: 0.9400
test Accuracy after query 135: 0.7902
Val Accuracy after query 140: 0.9400
test Accuracy after query 140: 0.7862
Val Accuracy after query 145: 0.9400
test Accuracy after query 145: 0.7954
Val Accuracy after query 150: 0.9300
test Accuracy after query 150: 0.8114
********** Test Accuracy per experiment: 0.8114 **********
********** Experiment 2 (uniform-MC_dropout=True): 0:6:4 **********
********** Experiment Iterations: 3/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4900
test Accuracy after query 5: 0.3394
Val Accuracy after query 10: 0.5500
test Accuracy after query 10: 0.4002
Val Accuracy after query 15: 0.6400
test Accuracy after query 15: 0.4858
Val Accuracy after query 20: 0.6900
test Accuracy after query 20: 0.5280
Val Accuracy after query 25: 0.7500
test Accuracy after query 25: 0.5302
Val Accuracy after query 30: 0.8000
test Accuracy after query 30: 0.5714
Val Accuracy after query 35: 0.8000
test Accuracy after query 35: 0.5820
Val Accuracy after query 40: 0.8100
test Accuracy after query 40: 0.6232
Val Accuracy after query 45: 0.8200
test Accuracy after query 45: 0.6404
Val Accuracy after query 50: 0.8300
test Accuracy after query 50: 0.6608
Val Accuracy after query 55: 0.8500
test Accuracy after query 55: 0.6688
Val Accuracy after query 60: 0.8500
test Accuracy after query 60: 0.6766
Val Accuracy after query 65: 0.8500
test Accuracy after query 65: 0.6872
Val Accuracy after query 70: 0.8600
test Accuracy after query 70: 0.7022
Val Accuracy after query 75: 0.8800
test Accuracy after query 75: 0.7294
Val Accuracy after query 80: 0.9000
test Accuracy after query 80: 0.7486
Val Accuracy after query 85: 0.8800
test Accuracy after query 85: 0.7756
Val Accuracy after query 90: 0.8900
test Accuracy after query 90: 0.7504
Val Accuracy after query 95: 0.9100
test Accuracy after query 95: 0.7654
Val Accuracy after query 100: 0.9000
test Accuracy after query 100: 0.7556
Val Accuracy after query 105: 0.9000
test Accuracy after query 105: 0.7634
Val Accuracy after query 110: 0.9100
test Accuracy after query 110: 0.7572
Val Accuracy after query 115: 0.9200
test Accuracy after query 115: 0.7954
Val Accuracy after query 120: 0.9300
test Accuracy after query 120: 0.7894
Val Accuracy after query 125: 0.9500
test Accuracy after query 125: 0.7992
Val Accuracy after query 130: 0.9600
test Accuracy after query 130: 0.8026
Val Accuracy after query 135: 0.9400
test Accuracy after query 135: 0.8020
Val Accuracy after query 140: 0.9200
test Accuracy after query 140: 0.7970
Val Accuracy after query 145: 0.9600
test Accuracy after query 145: 0.7984
Val Accuracy after query 150: 0.9500
test Accuracy after query 150: 0.7866
********** Test Accuracy per experiment: 0.7866 **********
********** Experiment 3 (uniform-MC_dropout=True): 0:6:5 **********
Average Test score for uniform-MC_dropout=True: 0.8017333333333333
Saved: result_npy/uniform-MC_dropout=TrueASL_MNIST_imbal.npy

---------- Start max_entropy-MC_dropout=True training! ----------
********** Experiment Iterations: 1/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4800
test Accuracy after query 5: 0.3572
Val Accuracy after query 10: 0.5300
test Accuracy after query 10: 0.4630
Val Accuracy after query 15: 0.6800
test Accuracy after query 15: 0.5408
Val Accuracy after query 20: 0.7400
test Accuracy after query 20: 0.5896
Val Accuracy after query 25: 0.7700
test Accuracy after query 25: 0.6532
Val Accuracy after query 30: 0.8400
test Accuracy after query 30: 0.6498
Val Accuracy after query 35: 0.8900
test Accuracy after query 35: 0.7048
Val Accuracy after query 40: 0.8500
test Accuracy after query 40: 0.7418
Val Accuracy after query 45: 0.8800
test Accuracy after query 45: 0.7864
Val Accuracy after query 50: 0.9200
test Accuracy after query 50: 0.8276
Val Accuracy after query 55: 0.9600
test Accuracy after query 55: 0.8492
Val Accuracy after query 60: 0.9500
test Accuracy after query 60: 0.8716
Val Accuracy after query 65: 0.9700
test Accuracy after query 65: 0.8902
Val Accuracy after query 70: 0.9900
test Accuracy after query 70: 0.8978
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.9040
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9182
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9370
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9302
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9218
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9294
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9296
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9276
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9300
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9358
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9372
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9446
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9372
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9296
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9276
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9356
********** Test Accuracy per experiment: 0.9356 **********
********** Experiment 1 (max_entropy-MC_dropout=True): 0:28:10 **********
********** Experiment Iterations: 2/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4200
test Accuracy after query 5: 0.3728
Val Accuracy after query 10: 0.5200
test Accuracy after query 10: 0.4548
Val Accuracy after query 15: 0.6000
test Accuracy after query 15: 0.5124
Val Accuracy after query 20: 0.7000
test Accuracy after query 20: 0.5812
Val Accuracy after query 25: 0.7700
test Accuracy after query 25: 0.6342
Val Accuracy after query 30: 0.8200
test Accuracy after query 30: 0.6990
Val Accuracy after query 35: 0.8000
test Accuracy after query 35: 0.7348
Val Accuracy after query 40: 0.8800
test Accuracy after query 40: 0.7774
Val Accuracy after query 45: 0.9400
test Accuracy after query 45: 0.7780
Val Accuracy after query 50: 0.9100
test Accuracy after query 50: 0.8142
Val Accuracy after query 55: 0.9200
test Accuracy after query 55: 0.8040
Val Accuracy after query 60: 0.9800
test Accuracy after query 60: 0.8240
Val Accuracy after query 65: 0.9800
test Accuracy after query 65: 0.8598
Val Accuracy after query 70: 0.9900
test Accuracy after query 70: 0.8824
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.8976
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9072
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9142
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9154
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.8996
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.8986
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9044
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9106
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9198
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9174
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9206
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9298
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9176
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9174
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9170
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9190
********** Test Accuracy per experiment: 0.919 **********
********** Experiment 2 (max_entropy-MC_dropout=True): 0:27:53 **********
********** Experiment Iterations: 3/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4100
test Accuracy after query 5: 0.4132
Val Accuracy after query 10: 0.5500
test Accuracy after query 10: 0.4962
Val Accuracy after query 15: 0.6700
test Accuracy after query 15: 0.5754
Val Accuracy after query 20: 0.7200
test Accuracy after query 20: 0.6350
Val Accuracy after query 25: 0.7500
test Accuracy after query 25: 0.6776
Val Accuracy after query 30: 0.8400
test Accuracy after query 30: 0.7036
Val Accuracy after query 35: 0.8700
test Accuracy after query 35: 0.7404
Val Accuracy after query 40: 0.9000
test Accuracy after query 40: 0.7616
Val Accuracy after query 45: 0.9100
test Accuracy after query 45: 0.8206
Val Accuracy after query 50: 0.8900
test Accuracy after query 50: 0.8330
Val Accuracy after query 55: 0.9300
test Accuracy after query 55: 0.8502
Val Accuracy after query 60: 0.9400
test Accuracy after query 60: 0.8888
Val Accuracy after query 65: 0.9800
test Accuracy after query 65: 0.9020
Val Accuracy after query 70: 0.9800
test Accuracy after query 70: 0.9054
Val Accuracy after query 75: 0.9900
test Accuracy after query 75: 0.9236
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9160
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9106
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9130
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9276
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9260
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9162
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9252
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9122
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9274
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9270
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9346
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9250
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9292
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9330
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9206
********** Test Accuracy per experiment: 0.9206 **********
********** Experiment 3 (max_entropy-MC_dropout=True): 0:27:57 **********
Average Test score for max_entropy-MC_dropout=True: 0.9250666666666666
Saved: result_npy/max_entropy-MC_dropout=TrueASL_MNIST_imbal.npy

---------- Start bald-MC_dropout=True training! ----------
********** Experiment Iterations: 1/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4100
test Accuracy after query 5: 0.3550
Val Accuracy after query 10: 0.4800
test Accuracy after query 10: 0.4056
Val Accuracy after query 15: 0.5500
test Accuracy after query 15: 0.4474
Val Accuracy after query 20: 0.7100
test Accuracy after query 20: 0.5198
Val Accuracy after query 25: 0.7700
test Accuracy after query 25: 0.5660
Val Accuracy after query 30: 0.7400
test Accuracy after query 30: 0.6344
Val Accuracy after query 35: 0.8300
test Accuracy after query 35: 0.6698
Val Accuracy after query 40: 0.8400
test Accuracy after query 40: 0.7300
Val Accuracy after query 45: 0.8900
test Accuracy after query 45: 0.7726
Val Accuracy after query 50: 0.9300
test Accuracy after query 50: 0.7958
Val Accuracy after query 55: 0.9500
test Accuracy after query 55: 0.8202
Val Accuracy after query 60: 0.9600
test Accuracy after query 60: 0.8488
Val Accuracy after query 65: 0.9700
test Accuracy after query 65: 0.8746
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.8712
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.9154
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9026
Val Accuracy after query 85: 0.9900
test Accuracy after query 85: 0.9060
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9116
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9182
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9228
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9276
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9274
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9240
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9276
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9400
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9370
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9228
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9300
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9304
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9226
********** Test Accuracy per experiment: 0.9226 **********
********** Experiment 1 (bald-MC_dropout=True): 0:28:17 **********
********** Experiment Iterations: 2/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4700
test Accuracy after query 5: 0.3430
Val Accuracy after query 10: 0.5500
test Accuracy after query 10: 0.4114
Val Accuracy after query 15: 0.6500
test Accuracy after query 15: 0.5574
Val Accuracy after query 20: 0.7600
test Accuracy after query 20: 0.6334
Val Accuracy after query 25: 0.7500
test Accuracy after query 25: 0.6736
Val Accuracy after query 30: 0.7700
test Accuracy after query 30: 0.6930
Val Accuracy after query 35: 0.8100
test Accuracy after query 35: 0.6940
Val Accuracy after query 40: 0.8400
test Accuracy after query 40: 0.7396
Val Accuracy after query 45: 0.8400
test Accuracy after query 45: 0.7758
Val Accuracy after query 50: 0.9300
test Accuracy after query 50: 0.8016
Val Accuracy after query 55: 0.9400
test Accuracy after query 55: 0.8360
Val Accuracy after query 60: 0.9700
test Accuracy after query 60: 0.8570
Val Accuracy after query 65: 0.9900
test Accuracy after query 65: 0.8926
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.8976
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.9156
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9022
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9222
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9144
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9176
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9290
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9302
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9276
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9392
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9332
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9114
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9356
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9192
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9362
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9270
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9414
********** Test Accuracy per experiment: 0.9414 **********
********** Experiment 2 (bald-MC_dropout=True): 0:28:21 **********
********** Experiment Iterations: 3/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4400
test Accuracy after query 5: 0.4084
Val Accuracy after query 10: 0.4800
test Accuracy after query 10: 0.4494
Val Accuracy after query 15: 0.6300
test Accuracy after query 15: 0.5078
Val Accuracy after query 20: 0.6900
test Accuracy after query 20: 0.5694
Val Accuracy after query 25: 0.7400
test Accuracy after query 25: 0.6430
Val Accuracy after query 30: 0.7800
test Accuracy after query 30: 0.6686
Val Accuracy after query 35: 0.8100
test Accuracy after query 35: 0.6890
Val Accuracy after query 40: 0.8800
test Accuracy after query 40: 0.7356
Val Accuracy after query 45: 0.9100
test Accuracy after query 45: 0.7814
Val Accuracy after query 50: 0.9400
test Accuracy after query 50: 0.8016
Val Accuracy after query 55: 0.9500
test Accuracy after query 55: 0.8194
Val Accuracy after query 60: 0.9700
test Accuracy after query 60: 0.8438
Val Accuracy after query 65: 0.9600
test Accuracy after query 65: 0.8796
Val Accuracy after query 70: 0.9900
test Accuracy after query 70: 0.8900
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.8970
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9076
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9234
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9180
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9250
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9324
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9184
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9286
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9310
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9266
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9302
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9248
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9320
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9286
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9234
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9154
********** Test Accuracy per experiment: 0.9154 **********
********** Experiment 3 (bald-MC_dropout=True): 0:28:20 **********
Average Test score for bald-MC_dropout=True: 0.9264666666666667
Saved: result_npy/bald-MC_dropout=TrueASL_MNIST_imbal.npy

---------- Start var_ratios-MC_dropout=True training! ----------
********** Experiment Iterations: 1/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4000
test Accuracy after query 5: 0.3980
Val Accuracy after query 10: 0.5300
test Accuracy after query 10: 0.4808
Val Accuracy after query 15: 0.5600
test Accuracy after query 15: 0.5428
Val Accuracy after query 20: 0.7100
test Accuracy after query 20: 0.5966
Val Accuracy after query 25: 0.7900
test Accuracy after query 25: 0.6490
Val Accuracy after query 30: 0.8400
test Accuracy after query 30: 0.7008
Val Accuracy after query 35: 0.8800
test Accuracy after query 35: 0.7434
Val Accuracy after query 40: 0.8800
test Accuracy after query 40: 0.7592
Val Accuracy after query 45: 0.8900
test Accuracy after query 45: 0.7764
Val Accuracy after query 50: 0.9300
test Accuracy after query 50: 0.8236
Val Accuracy after query 55: 0.9300
test Accuracy after query 55: 0.8384
Val Accuracy after query 60: 0.9900
test Accuracy after query 60: 0.8806
Val Accuracy after query 65: 0.9900
test Accuracy after query 65: 0.8952
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9070
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.9052
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9230
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9196
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9282
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9294
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9180
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9274
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9322
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9256
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9242
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9308
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9232
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9318
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9330
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9280
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9340
********** Test Accuracy per experiment: 0.934 **********
********** Experiment 1 (var_ratios-MC_dropout=True): 0:28:22 **********
********** Experiment Iterations: 2/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4500
test Accuracy after query 5: 0.3540
Val Accuracy after query 10: 0.5100
test Accuracy after query 10: 0.4084
Val Accuracy after query 15: 0.6100
test Accuracy after query 15: 0.4972
Val Accuracy after query 20: 0.7400
test Accuracy after query 20: 0.6254
Val Accuracy after query 25: 0.7300
test Accuracy after query 25: 0.6588
Val Accuracy after query 30: 0.8100
test Accuracy after query 30: 0.6844
Val Accuracy after query 35: 0.8400
test Accuracy after query 35: 0.7020
Val Accuracy after query 40: 0.9000
test Accuracy after query 40: 0.7772
Val Accuracy after query 45: 0.9400
test Accuracy after query 45: 0.8290
Val Accuracy after query 50: 0.9600
test Accuracy after query 50: 0.8034
Val Accuracy after query 55: 0.9400
test Accuracy after query 55: 0.8438
Val Accuracy after query 60: 0.9900
test Accuracy after query 60: 0.8698
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 0.8860
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9026
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.9106
Val Accuracy after query 80: 0.9900
test Accuracy after query 80: 0.9170
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9194
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9174
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9144
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9144
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9194
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9230
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9358
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9324
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9272
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9272
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9334
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9242
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9392
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9292
********** Test Accuracy per experiment: 0.9292 **********
********** Experiment 2 (var_ratios-MC_dropout=True): 0:28:21 **********
********** Experiment Iterations: 3/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4100
test Accuracy after query 5: 0.3296
Val Accuracy after query 10: 0.5800
test Accuracy after query 10: 0.4516
Val Accuracy after query 15: 0.6600
test Accuracy after query 15: 0.5550
Val Accuracy after query 20: 0.7100
test Accuracy after query 20: 0.5920
Val Accuracy after query 25: 0.7300
test Accuracy after query 25: 0.6440
Val Accuracy after query 30: 0.7400
test Accuracy after query 30: 0.6786
Val Accuracy after query 35: 0.8000
test Accuracy after query 35: 0.7194
Val Accuracy after query 40: 0.8300
test Accuracy after query 40: 0.7666
Val Accuracy after query 45: 0.8700
test Accuracy after query 45: 0.8136
Val Accuracy after query 50: 0.9200
test Accuracy after query 50: 0.8140
Val Accuracy after query 55: 0.9700
test Accuracy after query 55: 0.8182
Val Accuracy after query 60: 0.9700
test Accuracy after query 60: 0.8546
Val Accuracy after query 65: 0.9800
test Accuracy after query 65: 0.8596
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.8762
Val Accuracy after query 75: 1.0000
test Accuracy after query 75: 0.9098
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.9156
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9186
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9214
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9174
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9238
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9326
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9266
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9284
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9242
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9308
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9318
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9244
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9288
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9376
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9380
********** Test Accuracy per experiment: 0.938 **********
********** Experiment 3 (var_ratios-MC_dropout=True): 0:28:18 **********
Average Test score for var_ratios-MC_dropout=True: 0.9337333333333332
Saved: result_npy/var_ratios-MC_dropout=TrueASL_MNIST_imbal.npy

---------- Start mean_std-MC_dropout=True training! ----------
********** Experiment Iterations: 1/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.3800
test Accuracy after query 5: 0.2934
Val Accuracy after query 10: 0.4400
test Accuracy after query 10: 0.3972
Val Accuracy after query 15: 0.5800
test Accuracy after query 15: 0.4534
Val Accuracy after query 20: 0.6300
test Accuracy after query 20: 0.4918
Val Accuracy after query 25: 0.7000
test Accuracy after query 25: 0.5552
Val Accuracy after query 30: 0.7900
test Accuracy after query 30: 0.6522
Val Accuracy after query 35: 0.8300
test Accuracy after query 35: 0.7098
Val Accuracy after query 40: 0.8400
test Accuracy after query 40: 0.7550
Val Accuracy after query 45: 0.8800
test Accuracy after query 45: 0.7614
Val Accuracy after query 50: 0.9000
test Accuracy after query 50: 0.7868
Val Accuracy after query 55: 0.9400
test Accuracy after query 55: 0.8062
Val Accuracy after query 60: 0.9300
test Accuracy after query 60: 0.8322
Val Accuracy after query 65: 0.9300
test Accuracy after query 65: 0.8318
Val Accuracy after query 70: 0.9700
test Accuracy after query 70: 0.8472
Val Accuracy after query 75: 0.9800
test Accuracy after query 75: 0.8844
Val Accuracy after query 80: 1.0000
test Accuracy after query 80: 0.8752
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.8692
Val Accuracy after query 90: 0.9900
test Accuracy after query 90: 0.9064
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9046
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9056
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9014
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9188
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9148
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9264
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9210
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9238
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9272
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9254
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9146
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9188
********** Test Accuracy per experiment: 0.9188 **********
********** Experiment 1 (mean_std-MC_dropout=True): 0:28:7 **********
********** Experiment Iterations: 2/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4000
test Accuracy after query 5: 0.3848
Val Accuracy after query 10: 0.4300
test Accuracy after query 10: 0.3926
Val Accuracy after query 15: 0.5800
test Accuracy after query 15: 0.4922
Val Accuracy after query 20: 0.6700
test Accuracy after query 20: 0.5378
Val Accuracy after query 25: 0.7700
test Accuracy after query 25: 0.6308
Val Accuracy after query 30: 0.8000
test Accuracy after query 30: 0.6554
Val Accuracy after query 35: 0.8200
test Accuracy after query 35: 0.7048
Val Accuracy after query 40: 0.8600
test Accuracy after query 40: 0.7586
Val Accuracy after query 45: 0.9100
test Accuracy after query 45: 0.8088
Val Accuracy after query 50: 0.9000
test Accuracy after query 50: 0.8104
Val Accuracy after query 55: 0.9100
test Accuracy after query 55: 0.8170
Val Accuracy after query 60: 0.9000
test Accuracy after query 60: 0.8654
Val Accuracy after query 65: 0.9400
test Accuracy after query 65: 0.8706
Val Accuracy after query 70: 0.9700
test Accuracy after query 70: 0.8940
Val Accuracy after query 75: 0.9700
test Accuracy after query 75: 0.8994
Val Accuracy after query 80: 0.9900
test Accuracy after query 80: 0.8890
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9148
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9112
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9146
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9214
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9306
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9310
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9202
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9192
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9310
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9292
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9298
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9280
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9214
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9272
********** Test Accuracy per experiment: 0.9272 **********
********** Experiment 2 (mean_std-MC_dropout=True): 0:28:4 **********
********** Experiment Iterations: 3/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.4500
test Accuracy after query 5: 0.3096
Val Accuracy after query 10: 0.5500
test Accuracy after query 10: 0.4384
Val Accuracy after query 15: 0.6100
test Accuracy after query 15: 0.5194
Val Accuracy after query 20: 0.7300
test Accuracy after query 20: 0.5854
Val Accuracy after query 25: 0.7800
test Accuracy after query 25: 0.6472
Val Accuracy after query 30: 0.7800
test Accuracy after query 30: 0.6868
Val Accuracy after query 35: 0.8500
test Accuracy after query 35: 0.7178
Val Accuracy after query 40: 0.8600
test Accuracy after query 40: 0.7712
Val Accuracy after query 45: 0.8900
test Accuracy after query 45: 0.7860
Val Accuracy after query 50: 0.9000
test Accuracy after query 50: 0.8100
Val Accuracy after query 55: 0.9400
test Accuracy after query 55: 0.8488
Val Accuracy after query 60: 0.9700
test Accuracy after query 60: 0.8750
Val Accuracy after query 65: 0.9800
test Accuracy after query 65: 0.8946
Val Accuracy after query 70: 0.9800
test Accuracy after query 70: 0.9094
Val Accuracy after query 75: 0.9800
test Accuracy after query 75: 0.9118
Val Accuracy after query 80: 0.9900
test Accuracy after query 80: 0.9114
Val Accuracy after query 85: 1.0000
test Accuracy after query 85: 0.9274
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9346
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9296
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9302
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9282
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9292
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9350
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9318
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9374
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9310
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9414
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9358
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9330
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9330
********** Test Accuracy per experiment: 0.933 **********
********** Experiment 3 (mean_std-MC_dropout=True): 0:28:14 **********
Average Test score for mean_std-MC_dropout=True: 0.9263333333333333
Saved: result_npy/mean_std-MC_dropout=TrueASL_MNIST_imbal.npy
--------------- Done Training! ---------------
/home/wangsh/DBALwithImgData-main/main.py:60: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
