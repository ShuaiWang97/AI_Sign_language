/home/wangsh/DBALwithImgData-main/main.py:10: DeprecationWarning: Please use `gaussian_filter1d` from the `scipy.ndimage` namespace, the `scipy.ndimage.filters` namespace is deprecated.
  from scipy.ndimage.filters import gaussian_filter1d
Using device: cuda:0
state_loop:  [True]

---------- Start uniform-MC_dropout=True training! ----------
args.dataset is:  GSL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/1 **********
X_init.shape:  (46, 1, 28, 28)
y_init.shape:  (46,)
Val Accuracy after query 5: 0.1800
test Accuracy after query 5: 0.1246
Val Accuracy after query 10: 0.2300
test Accuracy after query 10: 0.1560
Val Accuracy after query 15: 0.2900
test Accuracy after query 15: 0.1844
Val Accuracy after query 20: 0.3000
test Accuracy after query 20: 0.2225
Val Accuracy after query 25: 0.3500
test Accuracy after query 25: 0.2476
Val Accuracy after query 30: 0.3800
test Accuracy after query 30: 0.2564
Val Accuracy after query 35: 0.4200
test Accuracy after query 35: 0.2890
Val Accuracy after query 40: 0.4600
test Accuracy after query 40: 0.3149
Val Accuracy after query 45: 0.5200
test Accuracy after query 45: 0.3409
Val Accuracy after query 50: 0.5000
test Accuracy after query 50: 0.3522
Val Accuracy after query 55: 0.6000
test Accuracy after query 55: 0.3609
Val Accuracy after query 60: 0.6200
test Accuracy after query 60: 0.3906
Val Accuracy after query 65: 0.6300
test Accuracy after query 65: 0.4065
Val Accuracy after query 70: 0.6600
test Accuracy after query 70: 0.4216
Val Accuracy after query 75: 0.6400
test Accuracy after query 75: 0.4274
Val Accuracy after query 80: 0.6900
test Accuracy after query 80: 0.4504
Val Accuracy after query 85: 0.6900
test Accuracy after query 85: 0.4450
Val Accuracy after query 90: 0.6700
test Accuracy after query 90: 0.4626
Val Accuracy after query 95: 0.7000
test Accuracy after query 95: 0.4734
Val Accuracy after query 100: 0.7300
test Accuracy after query 100: 0.5002
Val Accuracy after query 105: 0.7400
test Accuracy after query 105: 0.4981
Val Accuracy after query 110: 0.7500
test Accuracy after query 110: 0.5148
Val Accuracy after query 115: 0.7700
test Accuracy after query 115: 0.5224
Val Accuracy after query 120: 0.7800
test Accuracy after query 120: 0.5286
Val Accuracy after query 125: 0.7700
test Accuracy after query 125: 0.5194
Val Accuracy after query 130: 0.8200
test Accuracy after query 130: 0.5416
Val Accuracy after query 135: 0.8000
test Accuracy after query 135: 0.5370
Val Accuracy after query 140: 0.8000
test Accuracy after query 140: 0.5475
Val Accuracy after query 145: 0.8000
test Accuracy after query 145: 0.5579
Val Accuracy after query 150: 0.8100
test Accuracy after query 150: 0.5554
Val Accuracy after query 155: 0.8000
test Accuracy after query 155: 0.5533
Val Accuracy after query 160: 0.8200
test Accuracy after query 160: 0.5592
Val Accuracy after query 165: 0.8100
test Accuracy after query 165: 0.5772
Val Accuracy after query 170: 0.8100
test Accuracy after query 170: 0.5680
Val Accuracy after query 175: 0.8200
test Accuracy after query 175: 0.5788
Val Accuracy after query 180: 0.8500
test Accuracy after query 180: 0.5763
Val Accuracy after query 185: 0.8500
test Accuracy after query 185: 0.5910
Val Accuracy after query 190: 0.8400
test Accuracy after query 190: 0.5905
Val Accuracy after query 195: 0.8400
test Accuracy after query 195: 0.5968
Val Accuracy after query 200: 0.8400
test Accuracy after query 200: 0.5951
Val Accuracy after query 205: 0.8500
test Accuracy after query 205: 0.5905
Val Accuracy after query 210: 0.8400
test Accuracy after query 210: 0.6152
Val Accuracy after query 215: 0.8400
test Accuracy after query 215: 0.6056
Val Accuracy after query 220: 0.8500
test Accuracy after query 220: 0.5939
Val Accuracy after query 225: 0.8600
test Accuracy after query 225: 0.6010
Val Accuracy after query 230: 0.8800
test Accuracy after query 230: 0.6127
Val Accuracy after query 235: 0.8600
test Accuracy after query 235: 0.6156
Val Accuracy after query 240: 0.8900
test Accuracy after query 240: 0.6073
Val Accuracy after query 245: 0.8600
test Accuracy after query 245: 0.6102
Val Accuracy after query 250: 0.8900
test Accuracy after query 250: 0.6240
Val Accuracy after query 255: 0.8700
test Accuracy after query 255: 0.6123
Val Accuracy after query 260: 0.8700
test Accuracy after query 260: 0.6269
Val Accuracy after query 265: 0.8700
test Accuracy after query 265: 0.6156
Val Accuracy after query 270: 0.8600
test Accuracy after query 270: 0.6219
Val Accuracy after query 275: 0.8800
test Accuracy after query 275: 0.6282
Val Accuracy after query 280: 0.8800
test Accuracy after query 280: 0.6219
Val Accuracy after query 285: 0.8900
test Accuracy after query 285: 0.6177
Val Accuracy after query 290: 0.8700
test Accuracy after query 290: 0.6336
Val Accuracy after query 295: 0.8900
test Accuracy after query 295: 0.6286
Val Accuracy after query 300: 0.8700
test Accuracy after query 300: 0.6165
********** Test Accuracy per experiment: 0.616478460895023 **********
********** Experiment 1 (uniform-MC_dropout=True): 0:20:29 **********
Average Test score for uniform-MC_dropout=True: 0.616478460895023

---------- Start max_entropy-MC_dropout=True training! ----------
args.dataset is:  GSL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/1 **********
X_init.shape:  (46, 1, 28, 28)
y_init.shape:  (46,)
Val Accuracy after query 5: 0.1000
test Accuracy after query 5: 0.1138
Val Accuracy after query 10: 0.1200
test Accuracy after query 10: 0.1397
Val Accuracy after query 15: 0.1800
test Accuracy after query 15: 0.1598
Val Accuracy after query 20: 0.2300
test Accuracy after query 20: 0.1681
Val Accuracy after query 25: 0.3100
test Accuracy after query 25: 0.2041
Val Accuracy after query 30: 0.3000
test Accuracy after query 30: 0.2229
Val Accuracy after query 35: 0.3400
test Accuracy after query 35: 0.2405
Val Accuracy after query 40: 0.3900
test Accuracy after query 40: 0.2622
Val Accuracy after query 45: 0.3900
test Accuracy after query 45: 0.2861
Val Accuracy after query 50: 0.4100
test Accuracy after query 50: 0.3208
Val Accuracy after query 55: 0.4400
test Accuracy after query 55: 0.3379
Val Accuracy after query 60: 0.4800
test Accuracy after query 60: 0.3568
Val Accuracy after query 65: 0.5200
test Accuracy after query 65: 0.3760
Val Accuracy after query 70: 0.5500
test Accuracy after query 70: 0.3848
Val Accuracy after query 75: 0.6100
test Accuracy after query 75: 0.4090
Val Accuracy after query 80: 0.6400
test Accuracy after query 80: 0.4408
Val Accuracy after query 85: 0.6800
test Accuracy after query 85: 0.4588
Val Accuracy after query 90: 0.6400
test Accuracy after query 90: 0.4697
Val Accuracy after query 95: 0.7100
test Accuracy after query 95: 0.4872
Val Accuracy after query 100: 0.7100
test Accuracy after query 100: 0.5115
Val Accuracy after query 105: 0.7200
test Accuracy after query 105: 0.5165
Val Accuracy after query 110: 0.6900
test Accuracy after query 110: 0.5328
Val Accuracy after query 115: 0.7500
test Accuracy after query 115: 0.5471
Val Accuracy after query 120: 0.7000
test Accuracy after query 120: 0.5583
Val Accuracy after query 125: 0.7100
test Accuracy after query 125: 0.5646
Val Accuracy after query 130: 0.7600
test Accuracy after query 130: 0.5797
Val Accuracy after query 135: 0.7600
test Accuracy after query 135: 0.6006
Val Accuracy after query 140: 0.8400
test Accuracy after query 140: 0.6090
Val Accuracy after query 145: 0.8100
test Accuracy after query 145: 0.6236
Val Accuracy after query 150: 0.8200
test Accuracy after query 150: 0.6265
Val Accuracy after query 155: 0.8100
test Accuracy after query 155: 0.6470
Val Accuracy after query 160: 0.8500
test Accuracy after query 160: 0.6558
Val Accuracy after query 165: 0.8400
test Accuracy after query 165: 0.6570
Val Accuracy after query 170: 0.8300
test Accuracy after query 170: 0.6713
Val Accuracy after query 175: 0.8600
test Accuracy after query 175: 0.6872
Val Accuracy after query 180: 0.8400
test Accuracy after query 180: 0.6784
Val Accuracy after query 185: 0.8600
test Accuracy after query 185: 0.6826
Val Accuracy after query 190: 0.8500
test Accuracy after query 190: 0.6888
Val Accuracy after query 195: 0.8900
test Accuracy after query 195: 0.6855
Val Accuracy after query 200: 0.8900
test Accuracy after query 200: 0.6926
Val Accuracy after query 205: 0.9000
test Accuracy after query 205: 0.6959
Val Accuracy after query 210: 0.8500
test Accuracy after query 210: 0.7156
Val Accuracy after query 215: 0.8900
test Accuracy after query 215: 0.7005
Val Accuracy after query 220: 0.9100
test Accuracy after query 220: 0.7173
Val Accuracy after query 225: 0.9300
test Accuracy after query 225: 0.7269
Val Accuracy after query 230: 0.9300
test Accuracy after query 230: 0.7215
Val Accuracy after query 235: 0.9200
test Accuracy after query 235: 0.7244
Val Accuracy after query 240: 0.9400
test Accuracy after query 240: 0.7281
Val Accuracy after query 245: 0.9000
test Accuracy after query 245: 0.7332
Val Accuracy after query 250: 0.9600
test Accuracy after query 250: 0.7373
Val Accuracy after query 255: 0.9400
test Accuracy after query 255: 0.7369
Val Accuracy after query 260: 0.9500
test Accuracy after query 260: 0.7428
Val Accuracy after query 265: 0.9700
test Accuracy after query 265: 0.7486
Val Accuracy after query 270: 0.9500
test Accuracy after query 270: 0.7541
Val Accuracy after query 275: 0.9600
test Accuracy after query 275: 0.7578
Val Accuracy after query 280: 0.9500
test Accuracy after query 280: 0.7562
Val Accuracy after query 285: 0.9500
test Accuracy after query 285: 0.7604
Val Accuracy after query 290: 0.9500
test Accuracy after query 290: 0.7545
Val Accuracy after query 295: 0.9400
test Accuracy after query 295: 0.7616
Val Accuracy after query 300: 0.9500
test Accuracy after query 300: 0.7641
********** Test Accuracy per experiment: 0.7641154328732748 **********
********** Experiment 1 (max_entropy-MC_dropout=True): 1:52:4 **********
Average Test score for max_entropy-MC_dropout=True: 0.7641154328732748

---------- Start bald-MC_dropout=True training! ----------
args.dataset is:  GSL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/1 **********
X_init.shape:  (46, 1, 28, 28)
y_init.shape:  (46,)
Val Accuracy after query 5: 0.1100
test Accuracy after query 5: 0.1192
Val Accuracy after query 10: 0.1500
test Accuracy after query 10: 0.1485
Val Accuracy after query 15: 0.1900
test Accuracy after query 15: 0.1899
Val Accuracy after query 20: 0.3200
test Accuracy after query 20: 0.2133
Val Accuracy after query 25: 0.3300
test Accuracy after query 25: 0.2258
Val Accuracy after query 30: 0.3300
test Accuracy after query 30: 0.2581
Val Accuracy after query 35: 0.3800
test Accuracy after query 35: 0.2923
Val Accuracy after query 40: 0.4400
test Accuracy after query 40: 0.3124
Val Accuracy after query 45: 0.4300
test Accuracy after query 45: 0.3417
Val Accuracy after query 50: 0.4600
test Accuracy after query 50: 0.3634
Val Accuracy after query 55: 0.5600
test Accuracy after query 55: 0.3798
Val Accuracy after query 60: 0.5300
test Accuracy after query 60: 0.3936
Val Accuracy after query 65: 0.5700
test Accuracy after query 65: 0.4279
Val Accuracy after query 70: 0.6000
test Accuracy after query 70: 0.4308
Val Accuracy after query 75: 0.6400
test Accuracy after query 75: 0.4580
Val Accuracy after query 80: 0.6100
test Accuracy after query 80: 0.4764
Val Accuracy after query 85: 0.6300
test Accuracy after query 85: 0.4948
Val Accuracy after query 90: 0.6800
test Accuracy after query 90: 0.5102
Val Accuracy after query 95: 0.6800
test Accuracy after query 95: 0.5278
Val Accuracy after query 100: 0.6700
test Accuracy after query 100: 0.5362
Val Accuracy after query 105: 0.7100
test Accuracy after query 105: 0.5550
Val Accuracy after query 110: 0.7100
test Accuracy after query 110: 0.5596
Val Accuracy after query 115: 0.8000
test Accuracy after query 115: 0.5830
Val Accuracy after query 120: 0.7200
test Accuracy after query 120: 0.5947
Val Accuracy after query 125: 0.8000
test Accuracy after query 125: 0.6069
Val Accuracy after query 130: 0.8000
test Accuracy after query 130: 0.6110
Val Accuracy after query 135: 0.8200
test Accuracy after query 135: 0.6219
Val Accuracy after query 140: 0.7900
test Accuracy after query 140: 0.6202
Val Accuracy after query 145: 0.7900
test Accuracy after query 145: 0.6307
Val Accuracy after query 150: 0.8100
test Accuracy after query 150: 0.6428
Val Accuracy after query 155: 0.7900
test Accuracy after query 155: 0.6629
Val Accuracy after query 160: 0.8200
test Accuracy after query 160: 0.6600
Val Accuracy after query 165: 0.8100
test Accuracy after query 165: 0.6658
Val Accuracy after query 170: 0.8800
test Accuracy after query 170: 0.6738
Val Accuracy after query 175: 0.8500
test Accuracy after query 175: 0.6821
Val Accuracy after query 180: 0.8600
test Accuracy after query 180: 0.6893
Val Accuracy after query 185: 0.8400
test Accuracy after query 185: 0.6951
Val Accuracy after query 190: 0.8600
test Accuracy after query 190: 0.6972
Val Accuracy after query 195: 0.8600
test Accuracy after query 195: 0.6972
Val Accuracy after query 200: 0.8800
test Accuracy after query 200: 0.7039
Val Accuracy after query 205: 0.8700
test Accuracy after query 205: 0.7093
Val Accuracy after query 210: 0.8800
test Accuracy after query 210: 0.7102
Val Accuracy after query 215: 0.8900
test Accuracy after query 215: 0.7194
Val Accuracy after query 220: 0.8800
test Accuracy after query 220: 0.7194
Val Accuracy after query 225: 0.8800
test Accuracy after query 225: 0.7281
Val Accuracy after query 230: 0.9000
test Accuracy after query 230: 0.7323
Val Accuracy after query 235: 0.9000
test Accuracy after query 235: 0.7344
Val Accuracy after query 240: 0.9000
test Accuracy after query 240: 0.7445
Val Accuracy after query 245: 0.9100
test Accuracy after query 245: 0.7445
Val Accuracy after query 250: 0.9200
test Accuracy after query 250: 0.7365
Val Accuracy after query 255: 0.9300
test Accuracy after query 255: 0.7378
Val Accuracy after query 260: 0.9300
test Accuracy after query 260: 0.7436
Val Accuracy after query 265: 0.9200
test Accuracy after query 265: 0.7399
Val Accuracy after query 270: 0.9400
test Accuracy after query 270: 0.7528
Val Accuracy after query 275: 0.9300
test Accuracy after query 275: 0.7474
Val Accuracy after query 280: 0.9200
test Accuracy after query 280: 0.7507
Val Accuracy after query 285: 0.9500
test Accuracy after query 285: 0.7445
Val Accuracy after query 290: 0.9400
test Accuracy after query 290: 0.7495
Val Accuracy after query 295: 0.9300
test Accuracy after query 295: 0.7520
Val Accuracy after query 300: 0.9400
test Accuracy after query 300: 0.7558
********** Test Accuracy per experiment: 0.7557507319113341 **********
********** Experiment 1 (bald-MC_dropout=True): 2:4:34 **********
Average Test score for bald-MC_dropout=True: 0.7557507319113341

---------- Start var_ratios-MC_dropout=True training! ----------
args.dataset is:  GSL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/1 **********
X_init.shape:  (46, 1, 28, 28)
y_init.shape:  (46,)
Val Accuracy after query 5: 0.1800
test Accuracy after query 5: 0.1108
Val Accuracy after query 10: 0.2100
test Accuracy after query 10: 0.1435
Val Accuracy after query 15: 0.2800
test Accuracy after query 15: 0.1807
Val Accuracy after query 20: 0.3900
test Accuracy after query 20: 0.2104
Val Accuracy after query 25: 0.3700
test Accuracy after query 25: 0.2325
Val Accuracy after query 30: 0.4200
test Accuracy after query 30: 0.2551
Val Accuracy after query 35: 0.4400
test Accuracy after query 35: 0.2852
Val Accuracy after query 40: 0.4500
test Accuracy after query 40: 0.3099
Val Accuracy after query 45: 0.4500
test Accuracy after query 45: 0.3363
Val Accuracy after query 50: 0.4600
test Accuracy after query 50: 0.3538
Val Accuracy after query 55: 0.5100
test Accuracy after query 55: 0.3743
Val Accuracy after query 60: 0.5100
test Accuracy after query 60: 0.3961
Val Accuracy after query 65: 0.5800
test Accuracy after query 65: 0.4191
Val Accuracy after query 70: 0.5800
test Accuracy after query 70: 0.4555
Val Accuracy after query 75: 0.6400
test Accuracy after query 75: 0.4705
Val Accuracy after query 80: 0.6600
test Accuracy after query 80: 0.4810
Val Accuracy after query 85: 0.7000
test Accuracy after query 85: 0.5098
Val Accuracy after query 90: 0.6600
test Accuracy after query 90: 0.5182
Val Accuracy after query 95: 0.7000
test Accuracy after query 95: 0.5299
Val Accuracy after query 100: 0.7200
test Accuracy after query 100: 0.5445
Val Accuracy after query 105: 0.7500
test Accuracy after query 105: 0.5596
Val Accuracy after query 110: 0.7800
test Accuracy after query 110: 0.5688
Val Accuracy after query 115: 0.7400
test Accuracy after query 115: 0.5834
Val Accuracy after query 120: 0.7900
test Accuracy after query 120: 0.6014
Val Accuracy after query 125: 0.8100
test Accuracy after query 125: 0.6123
Val Accuracy after query 130: 0.8000
test Accuracy after query 130: 0.6340
Val Accuracy after query 135: 0.8100
test Accuracy after query 135: 0.6391
Val Accuracy after query 140: 0.8000
test Accuracy after query 140: 0.6512
Val Accuracy after query 145: 0.7900
test Accuracy after query 145: 0.6558
Val Accuracy after query 150: 0.8300
test Accuracy after query 150: 0.6650
Val Accuracy after query 155: 0.8200
test Accuracy after query 155: 0.6658
Val Accuracy after query 160: 0.8700
test Accuracy after query 160: 0.6780
Val Accuracy after query 165: 0.8400
test Accuracy after query 165: 0.6801
Val Accuracy after query 170: 0.8700
test Accuracy after query 170: 0.6867
Val Accuracy after query 175: 0.8900
test Accuracy after query 175: 0.6855
Val Accuracy after query 180: 0.8700
test Accuracy after query 180: 0.6959
Val Accuracy after query 185: 0.8800
test Accuracy after query 185: 0.7014
Val Accuracy after query 190: 0.9000
test Accuracy after query 190: 0.7152
Val Accuracy after query 195: 0.8900
test Accuracy after query 195: 0.7215
Val Accuracy after query 200: 0.9000
test Accuracy after query 200: 0.7118
Val Accuracy after query 205: 0.9100
test Accuracy after query 205: 0.7198
Val Accuracy after query 210: 0.8900
test Accuracy after query 210: 0.7273
Val Accuracy after query 215: 0.9200
test Accuracy after query 215: 0.7307
Val Accuracy after query 220: 0.9100
test Accuracy after query 220: 0.7403
Val Accuracy after query 225: 0.9000
test Accuracy after query 225: 0.7323
Val Accuracy after query 230: 0.9000
test Accuracy after query 230: 0.7445
Val Accuracy after query 235: 0.9200
test Accuracy after query 235: 0.7486
Val Accuracy after query 240: 0.9300
test Accuracy after query 240: 0.7499
Val Accuracy after query 245: 0.9100
test Accuracy after query 245: 0.7482
Val Accuracy after query 250: 0.9400
test Accuracy after query 250: 0.7574
Val Accuracy after query 255: 0.9300
test Accuracy after query 255: 0.7591
Val Accuracy after query 260: 0.9400
test Accuracy after query 260: 0.7583
Val Accuracy after query 265: 0.9400
test Accuracy after query 265: 0.7637
Val Accuracy after query 270: 0.9600
test Accuracy after query 270: 0.7650
Val Accuracy after query 275: 0.9600
test Accuracy after query 275: 0.7641
Val Accuracy after query 280: 0.9600
test Accuracy after query 280: 0.7599
Val Accuracy after query 285: 0.9600
test Accuracy after query 285: 0.7658
Val Accuracy after query 290: 0.9600
test Accuracy after query 290: 0.7704
Val Accuracy after query 295: 0.9600
test Accuracy after query 295: 0.7729
Val Accuracy after query 300: 0.9600
test Accuracy after query 300: 0.7679
********** Test Accuracy per experiment: 0.767879548306148 **********
********** Experiment 1 (var_ratios-MC_dropout=True): 1:45:1 **********
Average Test score for var_ratios-MC_dropout=True: 0.767879548306148

---------- Start mean_std-MC_dropout=True training! ----------
args.dataset is:  GSL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/1 **********
X_init.shape:  (46, 1, 28, 28)
y_init.shape:  (46,)
Val Accuracy after query 5: 0.1200
test Accuracy after query 5: 0.1276
Val Accuracy after query 10: 0.1700
test Accuracy after query 10: 0.1481
Val Accuracy after query 15: 0.2500
test Accuracy after query 15: 0.1807
Val Accuracy after query 20: 0.2800
test Accuracy after query 20: 0.2116
Val Accuracy after query 25: 0.3700
test Accuracy after query 25: 0.2455
Val Accuracy after query 30: 0.4000
test Accuracy after query 30: 0.2647
Val Accuracy after query 35: 0.4200
test Accuracy after query 35: 0.2911
Val Accuracy after query 40: 0.4200
test Accuracy after query 40: 0.3128
Val Accuracy after query 45: 0.3800
test Accuracy after query 45: 0.3346
Val Accuracy after query 50: 0.4400
test Accuracy after query 50: 0.3555
Val Accuracy after query 55: 0.4200
test Accuracy after query 55: 0.3664
Val Accuracy after query 60: 0.4500
test Accuracy after query 60: 0.3785
Val Accuracy after query 65: 0.4900
test Accuracy after query 65: 0.3931
Val Accuracy after query 70: 0.5000
test Accuracy after query 70: 0.4044
Val Accuracy after query 75: 0.5500
test Accuracy after query 75: 0.4287
Val Accuracy after query 80: 0.5800
test Accuracy after query 80: 0.4684
Val Accuracy after query 85: 0.5900
test Accuracy after query 85: 0.4609
Val Accuracy after query 90: 0.6100
test Accuracy after query 90: 0.4910
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 8906855 ON r30n7 CANCELLED AT 2022-04-07T17:39:37 DUE TO TIME LIMIT ***
slurmstepd: error: *** STEP 8906855.0 ON r30n7 CANCELLED AT 2022-04-07T17:39:37 DUE TO TIME LIMIT ***
