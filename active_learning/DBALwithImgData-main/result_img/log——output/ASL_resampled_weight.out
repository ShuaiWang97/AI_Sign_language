/home/wangsh/DBALwithImgData-main/main.py:10: DeprecationWarning: Please use `gaussian_filter1d` from the `scipy.ndimage` namespace, the `scipy.ndimage.filters` namespace is deprecated.
  from scipy.ndimage.filters import gaussian_filter1d
Using device: cuda:0
DataLoader :  <load_data.LoadASL_imbal_Data object at 0x151a586d2be0>

---------- Start uniform-MC_dropout=True training! ----------
********** Experiment Iterations: 1/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.5600
test Accuracy after query 5: 0.4680
Val Accuracy after query 10: 0.7000
test Accuracy after query 10: 0.4844
Val Accuracy after query 15: 0.8200
test Accuracy after query 15: 0.5368
Val Accuracy after query 20: 0.8000
test Accuracy after query 20: 0.5332
Val Accuracy after query 25: 0.8000
test Accuracy after query 25: 0.5570
Val Accuracy after query 30: 0.8300
test Accuracy after query 30: 0.5872
Val Accuracy after query 35: 0.8300
test Accuracy after query 35: 0.5854
Val Accuracy after query 40: 0.8500
test Accuracy after query 40: 0.6210
Val Accuracy after query 45: 0.8900
test Accuracy after query 45: 0.6460
Val Accuracy after query 50: 0.8900
test Accuracy after query 50: 0.6600
Val Accuracy after query 55: 0.8900
test Accuracy after query 55: 0.6342
Val Accuracy after query 60: 0.9200
test Accuracy after query 60: 0.6728
Val Accuracy after query 65: 0.9000
test Accuracy after query 65: 0.6892
Val Accuracy after query 70: 0.9100
test Accuracy after query 70: 0.7060
Val Accuracy after query 75: 0.9000
test Accuracy after query 75: 0.7026
Val Accuracy after query 80: 0.9300
test Accuracy after query 80: 0.7202
Val Accuracy after query 85: 0.9400
test Accuracy after query 85: 0.7218
Val Accuracy after query 90: 0.9600
test Accuracy after query 90: 0.7596
Val Accuracy after query 95: 0.9100
test Accuracy after query 95: 0.7522
Val Accuracy after query 100: 0.9400
test Accuracy after query 100: 0.7756
Val Accuracy after query 105: 0.9600
test Accuracy after query 105: 0.7900
Val Accuracy after query 110: 0.9500
test Accuracy after query 110: 0.7880
Val Accuracy after query 115: 0.9600
test Accuracy after query 115: 0.8024
Val Accuracy after query 120: 0.9500
test Accuracy after query 120: 0.7878
Val Accuracy after query 125: 0.9600
test Accuracy after query 125: 0.8084
Val Accuracy after query 130: 0.9700
test Accuracy after query 130: 0.7962
Val Accuracy after query 135: 0.9700
test Accuracy after query 135: 0.8078
Val Accuracy after query 140: 0.9600
test Accuracy after query 140: 0.8054
Val Accuracy after query 145: 0.9600
test Accuracy after query 145: 0.7962
Val Accuracy after query 150: 0.9500
test Accuracy after query 150: 0.8110
********** Test Accuracy per experiment: 0.811 **********
********** Experiment 1 (uniform-MC_dropout=True): 0:5:49 **********
********** Experiment Iterations: 2/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.5800
test Accuracy after query 5: 0.4342
Val Accuracy after query 10: 0.6500
test Accuracy after query 10: 0.4750
Val Accuracy after query 15: 0.7200
test Accuracy after query 15: 0.4868
Val Accuracy after query 20: 0.7500
test Accuracy after query 20: 0.5262
Val Accuracy after query 25: 0.7700
test Accuracy after query 25: 0.5596
Val Accuracy after query 30: 0.8300
test Accuracy after query 30: 0.5820
Val Accuracy after query 35: 0.8200
test Accuracy after query 35: 0.5918
Val Accuracy after query 40: 0.8400
test Accuracy after query 40: 0.6322
Val Accuracy after query 45: 0.8500
test Accuracy after query 45: 0.6566
Val Accuracy after query 50: 0.8600
test Accuracy after query 50: 0.6746
Val Accuracy after query 55: 0.8500
test Accuracy after query 55: 0.7088
Val Accuracy after query 60: 0.8600
test Accuracy after query 60: 0.6802
Val Accuracy after query 65: 0.9000
test Accuracy after query 65: 0.7118
Val Accuracy after query 70: 0.9100
test Accuracy after query 70: 0.7148
Val Accuracy after query 75: 0.8900
test Accuracy after query 75: 0.7004
Val Accuracy after query 80: 0.9100
test Accuracy after query 80: 0.7178
Val Accuracy after query 85: 0.9100
test Accuracy after query 85: 0.7402
Val Accuracy after query 90: 0.9100
test Accuracy after query 90: 0.7460
Val Accuracy after query 95: 0.9000
test Accuracy after query 95: 0.7412
Val Accuracy after query 100: 0.9100
test Accuracy after query 100: 0.7728
Val Accuracy after query 105: 0.9100
test Accuracy after query 105: 0.7416
Val Accuracy after query 110: 0.9200
test Accuracy after query 110: 0.7738
Val Accuracy after query 115: 0.9400
test Accuracy after query 115: 0.7878
Val Accuracy after query 120: 0.9200
test Accuracy after query 120: 0.7734
Val Accuracy after query 125: 0.9200
test Accuracy after query 125: 0.7908
Val Accuracy after query 130: 0.9400
test Accuracy after query 130: 0.7816
Val Accuracy after query 135: 0.9500
test Accuracy after query 135: 0.7952
Val Accuracy after query 140: 0.9600
test Accuracy after query 140: 0.8070
Val Accuracy after query 145: 0.9400
test Accuracy after query 145: 0.8094
Val Accuracy after query 150: 0.9600
test Accuracy after query 150: 0.8056
********** Test Accuracy per experiment: 0.8056 **********
********** Experiment 2 (uniform-MC_dropout=True): 0:5:38 **********
********** Experiment Iterations: 3/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.5300
test Accuracy after query 5: 0.4542
Val Accuracy after query 10: 0.5800
test Accuracy after query 10: 0.4768
Val Accuracy after query 15: 0.7000
test Accuracy after query 15: 0.5152
Val Accuracy after query 20: 0.7500
test Accuracy after query 20: 0.5280
Val Accuracy after query 25: 0.7200
test Accuracy after query 25: 0.5706
Val Accuracy after query 30: 0.8000
test Accuracy after query 30: 0.6118
Val Accuracy after query 35: 0.8500
test Accuracy after query 35: 0.6330
Val Accuracy after query 40: 0.8000
test Accuracy after query 40: 0.6580
Val Accuracy after query 45: 0.8700
test Accuracy after query 45: 0.6592
Val Accuracy after query 50: 0.8700
test Accuracy after query 50: 0.6500
Val Accuracy after query 55: 0.9000
test Accuracy after query 55: 0.7106
Val Accuracy after query 60: 0.9000
test Accuracy after query 60: 0.7070
Val Accuracy after query 65: 0.8900
test Accuracy after query 65: 0.7266
Val Accuracy after query 70: 0.9100
test Accuracy after query 70: 0.7254
Val Accuracy after query 75: 0.9200
test Accuracy after query 75: 0.7312
Val Accuracy after query 80: 0.9300
test Accuracy after query 80: 0.7506
Val Accuracy after query 85: 0.9300
test Accuracy after query 85: 0.7546
Val Accuracy after query 90: 0.9100
test Accuracy after query 90: 0.7542
Val Accuracy after query 95: 0.9300
test Accuracy after query 95: 0.7776
Val Accuracy after query 100: 0.9200
test Accuracy after query 100: 0.7744
Val Accuracy after query 105: 0.9200
test Accuracy after query 105: 0.7696
Val Accuracy after query 110: 0.9200
test Accuracy after query 110: 0.7670
Val Accuracy after query 115: 0.9200
test Accuracy after query 115: 0.7760
Val Accuracy after query 120: 0.9200
test Accuracy after query 120: 0.8024
Val Accuracy after query 125: 0.9200
test Accuracy after query 125: 0.7910
Val Accuracy after query 130: 0.9300
test Accuracy after query 130: 0.7824
Val Accuracy after query 135: 0.9300
test Accuracy after query 135: 0.7936
Val Accuracy after query 140: 0.9300
test Accuracy after query 140: 0.8016
Val Accuracy after query 145: 0.9200
test Accuracy after query 145: 0.8158
Val Accuracy after query 150: 0.9300
test Accuracy after query 150: 0.8104
********** Test Accuracy per experiment: 0.8104 **********
********** Experiment 3 (uniform-MC_dropout=True): 0:5:37 **********
Average Test score for uniform-MC_dropout=True: 0.809

---------- Start max_entropy-MC_dropout=True training! ----------
********** Experiment Iterations: 1/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.3400
test Accuracy after query 5: 0.3958
Val Accuracy after query 10: 0.5500
test Accuracy after query 10: 0.4480
Val Accuracy after query 15: 0.6900
test Accuracy after query 15: 0.5700
Val Accuracy after query 20: 0.7300
test Accuracy after query 20: 0.6132
Val Accuracy after query 25: 0.7400
test Accuracy after query 25: 0.6580
Val Accuracy after query 30: 0.7800
test Accuracy after query 30: 0.6962
Val Accuracy after query 35: 0.8100
test Accuracy after query 35: 0.7106
Val Accuracy after query 40: 0.8500
test Accuracy after query 40: 0.7484
Val Accuracy after query 45: 0.8400
test Accuracy after query 45: 0.7968
Val Accuracy after query 50: 0.9000
test Accuracy after query 50: 0.8148
Val Accuracy after query 55: 0.9300
test Accuracy after query 55: 0.8328
Val Accuracy after query 60: 0.9100
test Accuracy after query 60: 0.8536
Val Accuracy after query 65: 0.9700
test Accuracy after query 65: 0.8642
Val Accuracy after query 70: 0.9800
test Accuracy after query 70: 0.8806
Val Accuracy after query 75: 0.9800
test Accuracy after query 75: 0.8918
Val Accuracy after query 80: 0.9900
test Accuracy after query 80: 0.9100
Val Accuracy after query 85: 0.9900
test Accuracy after query 85: 0.9078
Val Accuracy after query 90: 1.0000
test Accuracy after query 90: 0.9228
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9336
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9262
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9288
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9352
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9368
Val Accuracy after query 120: 1.0000
test Accuracy after query 120: 0.9280
Val Accuracy after query 125: 1.0000
test Accuracy after query 125: 0.9348
Val Accuracy after query 130: 1.0000
test Accuracy after query 130: 0.9418
Val Accuracy after query 135: 1.0000
test Accuracy after query 135: 0.9406
Val Accuracy after query 140: 1.0000
test Accuracy after query 140: 0.9426
Val Accuracy after query 145: 1.0000
test Accuracy after query 145: 0.9348
Val Accuracy after query 150: 1.0000
test Accuracy after query 150: 0.9438
********** Test Accuracy per experiment: 0.9438 **********
********** Experiment 1 (max_entropy-MC_dropout=True): 0:26:45 **********
********** Experiment Iterations: 2/3 **********
X_init.shape:  (48, 1, 28, 28)
y_init.shape:  (48,)
Val Accuracy after query 5: 0.3800
test Accuracy after query 5: 0.3344
Val Accuracy after query 10: 0.5100
test Accuracy after query 10: 0.4436
Val Accuracy after query 15: 0.5600
test Accuracy after query 15: 0.4790
Val Accuracy after query 20: 0.6800
test Accuracy after query 20: 0.5472
Val Accuracy after query 25: 0.7500
test Accuracy after query 25: 0.6018
Val Accuracy after query 30: 0.7800
test Accuracy after query 30: 0.6734
Val Accuracy after query 35: 0.8300
test Accuracy after query 35: 0.6942
Val Accuracy after query 40: 0.8900
test Accuracy after query 40: 0.7354
Val Accuracy after query 45: 0.9000
test Accuracy after query 45: 0.7622
Val Accuracy after query 50: 0.9300
test Accuracy after query 50: 0.7780
Val Accuracy after query 55: 0.9400
test Accuracy after query 55: 0.8138
Val Accuracy after query 60: 0.9400
test Accuracy after query 60: 0.8186
Val Accuracy after query 65: 0.9800
test Accuracy after query 65: 0.8768
Val Accuracy after query 70: 0.9900
test Accuracy after query 70: 0.8906
Val Accuracy after query 75: 0.9900
test Accuracy after query 75: 0.8900
Val Accuracy after query 80: 0.9900
test Accuracy after query 80: 0.8884
Val Accuracy after query 85: 0.9900
test Accuracy after query 85: 0.9056
Val Accuracy after query 90: 0.9900
test Accuracy after query 90: 0.9166
Val Accuracy after query 95: 1.0000
test Accuracy after query 95: 0.9276
Val Accuracy after query 100: 1.0000
test Accuracy after query 100: 0.9332
Val Accuracy after query 105: 1.0000
test Accuracy after query 105: 0.9290
Val Accuracy after query 110: 1.0000
test Accuracy after query 110: 0.9388
Val Accuracy after query 115: 1.0000
test Accuracy after query 115: 0.9410
srun: Job step aborted: Waiting up to 32 seconds for job step to finish.
slurmstepd: error: *** JOB 8785204 ON r31n4 CANCELLED AT 2022-03-09T12:04:28 ***
