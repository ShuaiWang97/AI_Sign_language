/home/wangsh/DBALwithImgData-main/main.py:10: DeprecationWarning: Please use `gaussian_filter1d` from the `scipy.ndimage` namespace, the `scipy.ndimage.filters` namespace is deprecated.
  from scipy.ndimage.filters import gaussian_filter1d
Using device: cuda:0

---------- Start uniform-MC_dropout=True training! ----------
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9500
test Accuracy after query 5: 0.9556
Val Accuracy after query 10: 0.9700
test Accuracy after query 10: 0.9499
Val Accuracy after query 15: 0.9600
test Accuracy after query 15: 0.9612
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 0.9781
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 0.9790
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 0.9800
Val Accuracy after query 35: 0.9900
test Accuracy after query 35: 0.9815
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 0.9834
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 0.9831
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 0.9847
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 0.9844
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 0.9859
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 0.9890
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9869
********** Test Accuracy per experiment: 0.9868544600938968 **********
********** Experiment 1 (uniform-MC_dropout=True): 0:1:32 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 2/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9700
Val Accuracy after query 10: 0.9600
test Accuracy after query 10: 0.9690
Val Accuracy after query 15: 0.9700
test Accuracy after query 15: 0.9800
Val Accuracy after query 20: 0.9800
test Accuracy after query 20: 0.9822
Val Accuracy after query 25: 0.9800
test Accuracy after query 25: 0.9809
Val Accuracy after query 30: 0.9800
test Accuracy after query 30: 0.9884
Val Accuracy after query 35: 0.9800
test Accuracy after query 35: 0.9840
Val Accuracy after query 40: 0.9800
test Accuracy after query 40: 0.9869
Val Accuracy after query 45: 0.9800
test Accuracy after query 45: 0.9881
Val Accuracy after query 50: 0.9800
test Accuracy after query 50: 0.9887
Val Accuracy after query 55: 0.9800
test Accuracy after query 55: 0.9897
Val Accuracy after query 60: 0.9800
test Accuracy after query 60: 0.9912
Val Accuracy after query 65: 0.9800
test Accuracy after query 65: 0.9931
Val Accuracy after query 70: 0.9800
test Accuracy after query 70: 0.9934
********** Test Accuracy per experiment: 0.9934272300469483 **********
********** Experiment 2 (uniform-MC_dropout=True): 0:1:27 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 3/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9609
Val Accuracy after query 10: 0.9800
test Accuracy after query 10: 0.9734
Val Accuracy after query 15: 0.9900
test Accuracy after query 15: 0.9787
Val Accuracy after query 20: 0.9900
test Accuracy after query 20: 0.9793
Val Accuracy after query 25: 0.9900
test Accuracy after query 25: 0.9809
Val Accuracy after query 30: 0.9900
test Accuracy after query 30: 0.9837
Val Accuracy after query 35: 0.9900
test Accuracy after query 35: 0.9818
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 0.9800
Val Accuracy after query 45: 0.9900
test Accuracy after query 45: 0.9822
Val Accuracy after query 50: 0.9900
test Accuracy after query 50: 0.9837
Val Accuracy after query 55: 0.9900
test Accuracy after query 55: 0.9815
Val Accuracy after query 60: 0.9900
test Accuracy after query 60: 0.9847
Val Accuracy after query 65: 0.9900
test Accuracy after query 65: 0.9853
Val Accuracy after query 70: 0.9900
test Accuracy after query 70: 0.9822
********** Test Accuracy per experiment: 0.9821596244131455 **********
********** Experiment 3 (uniform-MC_dropout=True): 0:1:27 **********
Average Test score for uniform-MC_dropout=True: 0.9874804381846635

---------- Start max_entropy-MC_dropout=True training! ----------
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9784
Val Accuracy after query 10: 1.0000
test Accuracy after query 10: 0.9931
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9981
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 1.0000
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 1.0000
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 1.0000
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 1.0000
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 1.0000
********** Test Accuracy per experiment: 1.0 **********
********** Experiment 1 (max_entropy-MC_dropout=True): 0:6:3 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 2/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9740
Val Accuracy after query 10: 0.9900
test Accuracy after query 10: 0.9906
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9987
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 0.9997
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 0.9987
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 0.9997
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 1.0000
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 0.9997
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 1.0000
********** Test Accuracy per experiment: 1.0 **********
********** Experiment 2 (max_entropy-MC_dropout=True): 0:6:1 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 3/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9759
Val Accuracy after query 10: 0.9900
test Accuracy after query 10: 0.9897
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9987
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 1.0000
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 1.0000
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 0.9994
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 1.0000
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 0.9997
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9991
********** Test Accuracy per experiment: 0.9990610328638497 **********
********** Experiment 3 (max_entropy-MC_dropout=True): 0:6:1 **********
Average Test score for max_entropy-MC_dropout=True: 0.9996870109546165

---------- Start bald-MC_dropout=True training! ----------
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9300
test Accuracy after query 5: 0.9624
Val Accuracy after query 10: 0.9800
test Accuracy after query 10: 0.9865
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9966
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 1.0000
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 0.9997
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 0.9997
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 0.9997
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 0.9997
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9997
********** Test Accuracy per experiment: 0.9996870109546165 **********
********** Experiment 1 (bald-MC_dropout=True): 0:6:6 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 2/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9600
test Accuracy after query 5: 0.9700
Val Accuracy after query 10: 0.9900
test Accuracy after query 10: 0.9875
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 1.0000
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 0.9997
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 0.9987
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 1.0000
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 0.9994
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 0.9997
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 1.0000
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 1.0000
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 0.9994
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9987
********** Test Accuracy per experiment: 0.9987480438184664 **********
********** Experiment 2 (bald-MC_dropout=True): 0:6:5 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 3/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9800
test Accuracy after query 5: 0.9746
Val Accuracy after query 10: 0.9800
test Accuracy after query 10: 0.9925
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9962
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 1.0000
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 1.0000
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 1.0000
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 1.0000
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 1.0000
********** Test Accuracy per experiment: 1.0 **********
********** Experiment 3 (bald-MC_dropout=True): 0:6:6 **********
Average Test score for bald-MC_dropout=True: 0.9994783515910276

---------- Start var_ratios-MC_dropout=True training! ----------
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9859
Val Accuracy after query 10: 0.9900
test Accuracy after query 10: 0.9944
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9997
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 0.9997
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 0.9997
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 0.9997
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 0.9997
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 0.9994
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 0.9994
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 0.9994
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 0.9997
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9987
********** Test Accuracy per experiment: 0.9987480438184664 **********
********** Experiment 1 (var_ratios-MC_dropout=True): 0:6:7 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 2/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9847
Val Accuracy after query 10: 0.9700
test Accuracy after query 10: 0.9872
Val Accuracy after query 15: 0.9900
test Accuracy after query 15: 0.9897
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 0.9997
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 0.9997
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 1.0000
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 1.0000
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 1.0000
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9997
********** Test Accuracy per experiment: 0.9996870109546165 **********
********** Experiment 2 (var_ratios-MC_dropout=True): 0:6:2 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 3/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9806
Val Accuracy after query 10: 0.9700
test Accuracy after query 10: 0.9850
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9991
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 0.9944
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 0.9994
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 1.0000
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 0.9987
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 0.9997
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 0.9997
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 1.0000
********** Test Accuracy per experiment: 1.0 **********
********** Experiment 3 (var_ratios-MC_dropout=True): 0:6:4 **********
Average Test score for var_ratios-MC_dropout=True: 0.9994783515910276

---------- Start mean_std-MC_dropout=True training! ----------
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 1/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9756
Val Accuracy after query 10: 0.9900
test Accuracy after query 10: 0.9894
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9984
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 1.0000
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 1.0000
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 1.0000
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 1.0000
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 1.0000
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 1.0000
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 1.0000
********** Test Accuracy per experiment: 1.0 **********
********** Experiment 1 (mean_std-MC_dropout=True): 0:5:59 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 2/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9700
test Accuracy after query 5: 0.9690
Val Accuracy after query 10: 0.9800
test Accuracy after query 10: 0.9897
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9969
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 0.9987
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 1.0000
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 0.9997
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 0.9987
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 0.9994
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 0.9997
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 0.9994
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 0.9997
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 0.9997
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 1.0000
********** Test Accuracy per experiment: 1.0 **********
********** Experiment 2 (mean_std-MC_dropout=True): 0:5:57 **********
args.dataset is:  ISL_MNIST_imbal
label_num is:  26
********** Experiment Iterations: 3/3 **********
X_init.shape:  (52, 1, 28, 28)
y_init.shape:  (52,)
Val Accuracy after query 5: 0.9900
test Accuracy after query 5: 0.9840
Val Accuracy after query 10: 0.9900
test Accuracy after query 10: 0.9941
Val Accuracy after query 15: 1.0000
test Accuracy after query 15: 0.9972
Val Accuracy after query 20: 1.0000
test Accuracy after query 20: 0.9987
Val Accuracy after query 25: 1.0000
test Accuracy after query 25: 0.9987
Val Accuracy after query 30: 1.0000
test Accuracy after query 30: 1.0000
Val Accuracy after query 35: 1.0000
test Accuracy after query 35: 1.0000
Val Accuracy after query 40: 1.0000
test Accuracy after query 40: 0.9997
Val Accuracy after query 45: 1.0000
test Accuracy after query 45: 1.0000
Val Accuracy after query 50: 1.0000
test Accuracy after query 50: 0.9997
Val Accuracy after query 55: 1.0000
test Accuracy after query 55: 0.9997
Val Accuracy after query 60: 1.0000
test Accuracy after query 60: 1.0000
Val Accuracy after query 65: 1.0000
test Accuracy after query 65: 1.0000
Val Accuracy after query 70: 1.0000
test Accuracy after query 70: 0.9997
********** Test Accuracy per experiment: 0.9996870109546165 **********
********** Experiment 3 (mean_std-MC_dropout=True): 0:5:57 **********
Average Test score for mean_std-MC_dropout=True: 0.9998956703182055
--------------- Done Training! ---------------
/home/wangsh/DBALwithImgData-main/main.py:63: UserWarning: Matplotlib is currently using agg, which is a non-GUI backend, so cannot show the figure.
  plt.show()
